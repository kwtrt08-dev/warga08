<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RT 08/RW 05 - Website Resmi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            color: #666;
            font-size: 1.1em;
        }

        nav {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        nav button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        nav button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        nav button.active {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.5);
        }

        .content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 400px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .org-chart {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .org-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .org-card:hover {
            transform: translateY(-5px);
        }

        .org-card h3 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .org-card p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .info-box {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #667eea;
        }

        .schedule-item {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .schedule-item h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .contact-card {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .contact-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
        }

        .alert {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .success-box {
            background: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }
            
            nav ul {
                flex-direction: column;
            }
            
            nav button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèòÔ∏è RT 08/RW 05</h1>
            <p>Dusun Karangbawang, Desa Kawunganten, Kecamatan Kawunganten</p>
            <p style="font-size: 0.9em; color: #999;">Kabupaten Cilacap, Jawa Tengah</p>
        </header>

        <nav>
            <ul>
                <li><button class="active" onclick="showSection('beranda')">üè† Beranda</button></li>
                <li><button onclick="showSection('struktur')">üë• Struktur Organisasi</button></li>
                <li><button onclick="showSection('keuangan')">üí∞ Keuangan</button></li>
                <li><button onclick="showSection('ronda')">üî¶ Jadwal Ronda</button></li>
                <li><button onclick="showSection('kegiatan')">üìÖ Kegiatan</button></li>
                <li><button onclick="showSection('pengumuman')">üì¢ Pengumuman</button></li>
                <li><button onclick="showSection('kontak')">üìû Kontak</button></li>
            </ul>
        </nav>

        <div class="content">
            <!-- Beranda -->
            <div id="beranda" class="section active">
                <h2>Selamat Datang di Website RT 08/RW 05</h2>
                
                <div class="success-box">
                    <h3>‚úÖ Terhubung dengan Google Sheets</h3>
                    <p>Website ini mengambil data real-time dari Google Sheets!</p>
                    <p style="font-size: 0.9em; margin-top: 10px;">Update data di Google Sheets, otomatis tampil di website</p>
                </div>

                <h3 style="margin-top: 30px; color: #667eea;">Statistik RT</h3>
                <div class="contact-info">
                    <div class="contact-card">
                        <h4>45 KK</h4>
                        <p>Kepala Keluarga</p>
                    </div>
                    <div class="contact-card">
                        <h4>160 Jiwa</h4>
                        <p>Total Warga</p>
                    </div>
                    <div class="contact-card">
                        <h4>Karangbawang</h4>
                        <p>Dusun</p>
                    </div>
                </div>
            </div>

            <!-- Struktur Organisasi -->
            <div id="struktur" class="section">
                <h2>Struktur Organisasi RT 08/RW 05</h2>
                <p>Periode 2023-2026</p>
                
                <div id="strukturContent" class="org-chart">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>
            </div>

            <!-- Keuangan -->
            <div id="keuangan" class="section">
                <h2>Laporan Keuangan RT</h2>
                
                <div class="info-box">
                    <h3>üí∞ Saldo Kas RT (November 2025)</h3>
                    <h2 id="saldoAkhir" style="color: #4CAF50; border: none;">Rp 0</h2>
                </div>

                <h3>Laporan Bulan November 2025</h3>
                <div id="keuanganContent">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>
            </div>

            <!-- Jadwal Ronda -->
            <div id="ronda" class="section">
                <h2>Jadwal Ronda Malam</h2>
                <p>Periode: Desember 2025</p>

                <div class="info-box">
                    <strong>‚è∞ Waktu Ronda:</strong> 22.00 - 05.00 WIB<br>
                    <strong>üìç Pos Ronda:</strong> Depan Rumah Pak RT
                </div>

                <div id="rondaContent">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>
            </div>

            <!-- Kegiatan -->
            <div id="kegiatan" class="section">
                <h2>Kegiatan RT</h2>
                <h3>üìÖ Kegiatan Rutin</h3>
                
                <div id="kegiatanContent">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>
            </div>

            <!-- Pengumuman -->
            <div id="pengumuman" class="section">
                <h2>Pengumuman & Informasi</h2>
                
                <div id="pengumumanContent">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>
            </div>

            <!-- Kontak -->
            <div id="kontak" class="section">
                <h2>Hubungi Kami</h2>

                <div id="kontakContent" class="contact-info">
                    <div style="text-align: center; padding: 20px;">‚è≥ Memuat data...</div>
                </div>

                <div class="info-box" style="margin-top: 30px;">
                    <h3>üìç Alamat Sekretariat RT</h3>
                    <p>RT 08/RW 05</p>
                    <p>Dusun Karangbawang</p>
                    <p>Desa Kawunganten, Kecamatan Kawunganten</p>
                    <p>Kabupaten Cilacap, Jawa Tengah</p>
                    <p><strong>Kode Pos:</strong> 53253</p>
                </div>

                <div class="info-box">
                    <h3>‚è∞ Jam Pelayanan</h3>
                    <p><strong>Senin - Jumat:</strong> 16.00 - 20.00 WIB</p>
                    <p><strong>Sabtu - Minggu:</strong> 08.00 - 12.00 WIB</p>
                    <p><em>Untuk keperluan mendesak, dapat menghubungi langsung nomor Ketua RT</em></p>
                </div>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 RT 08/RW 05 Dusun Karangbawang, Desa Kawunganten. Data real-time dari Google Sheets.</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Dibuat dengan ‚ù§Ô∏è untuk warga RT</p>
        </footer>
    </div>

    <script>
        // GANTI URL INI DENGAN APPS SCRIPT URL ANDA
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw7jgDjroyJgM8cGvKZuz54IMlfu5vL6YLfIQRsS8THmWLPbgNzqGzcmuppddwBOwvo/exec';
        
        const SHEETS = {
            struktur: 'Struktur_Organisasi',
            keuangan: 'Keuangan', 
            ronda: 'Jadwal_Ronda',
            kegiatan: 'Kegiatan',
            pengumuman: 'Pengumuman'
        };

        // Fetch data menggunakan XMLHttpRequest
        async function fetchSheetData(sheetName) {
            try {
                const url = `${APPS_SCRIPT_URL}?sheet=${encodeURIComponent(sheetName)}`;
                
                return new Promise((resolve, reject) => {
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', url, true);
                    
                    xhr.onload = function() {
                        if (xhr.status >= 200 && xhr.status < 300) {
                            try {
                                const data = JSON.parse(xhr.responseText);
                                resolve(data);
                            } catch (e) {
                                reject(e);
                            }
                        } else {
                            reject(new Error(`HTTP ${xhr.status}`));
                        }
                    };
                    
                    xhr.onerror = () => reject(new Error('Network error'));
                    xhr.send();
                });
                
            } catch (error) {
                console.error('Error:', error);
                return null;
            }
        }

        // Load Struktur Organisasi
        async function loadStruktur() {
            const data = await fetchSheetData(SHEETS.struktur);
            const container = document.getElementById('strukturContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            container.innerHTML = '';
            data.forEach(row => {
                const card = document.createElement('div');
                card.className = 'org-card';
                card.innerHTML = `
                    <h3>${row.Jabatan || 'N/A'}</h3>
                    <p><strong>${row.Nama || 'N/A'}</strong></p>
                    <p>üì± ${row.No_HP || 'N/A'}</p>
                    ${row.Email ? `<p>${row.Email}</p>` : ''}
                `;
                container.appendChild(card);
            });
        }

        // Load Keuangan
        async function loadKeuangan() {
            const data = await fetchSheetData(SHEETS.keuangan);
            const container = document.getElementById('keuanganContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            let table = '<table><thead><tr><th>Tanggal</th><th>Keterangan</th><th>Pemasukan</th><th>Pengeluaran</th><th>Saldo</th></tr></thead><tbody>';
            
            data.forEach(row => {
                const pemasukan = parseInt(row.Pemasukan || row.pemasukan || 0);
                const pengeluaran = parseInt(row.Pengeluaran || row.pengeluaran || 0);
                const saldo = parseInt(row.Saldo || row.saldo || 0);
                
                table += `<tr>
                    <td>${row.Tanggal || '-'}</td>
                    <td>${row.Keterangan || '-'}</td>
                    <td>${pemasukan ? 'Rp ' + pemasukan.toLocaleString('id-ID') : '-'}</td>
                    <td>${pengeluaran ? 'Rp ' + pengeluaran.toLocaleString('id-ID') : '-'}</td>
                    <td>Rp ${saldo.toLocaleString('id-ID')}</td>
                </tr>`;
            });
            
            table += '</tbody></table>';
            container.innerHTML = table;
            
            if (data.length > 0) {
                const saldoAkhir = parseInt(data[data.length - 1].Saldo || data[data.length - 1].saldo || 0);
                document.getElementById('saldoAkhir').textContent = 'Rp ' + saldoAkhir.toLocaleString('id-ID');
            }
        }

        // Load Jadwal Ronda
        async function loadRonda() {
            const data = await fetchSheetData(SHEETS.ronda);
            const container = document.getElementById('rondaContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            let html = '<table><thead><tr><th style="width: 120px;">Hari</th><th>Nama Petugas Ronda</th></tr></thead><tbody>';
            
            data.forEach(row => {
                const hari = row.Hari || row.hari || row.Tanggal || row.tanggal || '-';
                let petugas = [];
                
                for (let i = 1; i <= 10; i++) {
                    const val = row[`Petugas_${i}`] || row[`petugas_${i}`] || '';
                    if (val && val.trim()) petugas.push(val.trim());
                }
                
                if (petugas.length > 0) {
                    html += `<tr>
                        <td><strong>${hari}</strong></td>
                        <td>${petugas.join(', ')}</td>
                    </tr>`;
                }
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }

        // Load Kegiatan
        async function loadKegiatan() {
            const data = await fetchSheetData(SHEETS.kegiatan);
            const container = document.getElementById('kegiatanContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            let html = '';
            data.forEach(row => {
                const nama = row.Nama_Kegiatan || row.nama_kegiatan || 'Kegiatan';
                const jadwal = row.Jadwal || row.jadwal || '-';
                const waktu = row.Waktu || row.waktu || '-';
                const lokasi = row.Lokasi || row.lokasi || '-';
                
                html += `<div class="schedule-item">
                    <h4>${nama}</h4>
                    <p><strong>Jadwal:</strong> ${jadwal}, ${waktu}</p>
                    <p><strong>Lokasi:</strong> ${lokasi}</p>
                </div>`;
            });
            
            container.innerHTML = html;
        }

        // Load Pengumuman
        async function loadPengumuman() {
            const data = await fetchSheetData(SHEETS.pengumuman);
            const container = document.getElementById('pengumumanContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            let html = '';
            data.forEach(row => {
                const judul = row.Judul || row.judul || 'Pengumuman';
                const tanggal = row.Tanggal || row.tanggal || '-';
                const isi = row.Isi_Pengumuman || row.isi_pengumuman || row.Isi || '';
                const prioritas = (row.Prioritas || row.prioritas || '').toLowerCase();
                
                const alertClass = prioritas === 'tinggi' ? 'alert' : 'schedule-item';
                const icon = prioritas === 'tinggi' ? 'üö® ' : 'üì¢ ';
                
                html += `<div class="${alertClass}">
                    <h4>${icon}${judul}</h4>
                    <p><strong>Tanggal:</strong> ${tanggal}</p>
                    <p>${isi}</p>
                </div>`;
            });
            
            container.innerHTML = html;
        }

        // Load Kontak
        async function loadKontak() {
            const data = await fetchSheetData(SHEETS.struktur);
            const container = document.getElementById('kontakContent');
            
            if (!data || data.length === 0) {
                container.innerHTML = '<p style="color: red; text-align: center;">‚ùå Gagal memuat data</p>';
                return;
            }

            container.innerHTML = '';
            const important = ['Ketua RT', 'Bendahara', 'Sie. Keamanan'];
            const filtered = data.filter(row => important.includes(row.Jabatan));
            
            filtered.forEach(row => {
                const card = document.createElement('div');
                card.className = 'contact-card';
                const icon = row.Jabatan === 'Ketua RT' ? 'üì±' : row.Jabatan === 'Bendahara' ? 'üí∞' : 'üî¶';
                card.innerHTML = `
                    <h4>${icon} ${row.Jabatan}</h4>
                    <p><strong>${row.Nama}</strong></p>
                    <p>${row.No_HP}</p>
                    ${row.Email ? `<p>${row.Email}</p>` : ''}
                `;
                container.appendChild(card);
            });
        }

        // Show section
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Load semua data
        window.addEventListener('load', () => {
            loadStruktur();
            loadKeuangan();
            loadRonda();
            loadKegiatan();
            loadPengumuman();
            loadKontak();
        });
    </script>
</body>
</html>